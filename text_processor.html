<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–‡æœ¬æŸ¥æ‰¾æ›¿æ¢å·¥å…·</title>
    <style>
      /* :root å®šä¹‰ CSS å˜é‡ï¼Œç”¨äºä¸»é¢˜åŒ–å’Œç»Ÿä¸€æ ·å¼ */
      :root {
        --bg-color: #f0f0f0; /* èƒŒæ™¯é¢œè‰² */
        --text-color: #333; /* æ–‡æœ¬é¢œè‰² */
        --input-bg: #fff; /* è¾“å…¥æ¡†èƒŒæ™¯é¢œè‰² */
        --input-border: #ccc; /* è¾“å…¥æ¡†è¾¹æ¡†é¢œè‰² */
        --button-bg: #007bff; /* æŒ‰é’®èƒŒæ™¯é¢œè‰² */
        --button-text: #fff; /* æŒ‰é’®æ–‡æœ¬é¢œè‰² */
        --button-hover-bg: #0056b3; /* æŒ‰é’®æ‚¬åœèƒŒæ™¯é¢œè‰² */
        --highlight-bg: rgba(86, 130, 3, 0.4); /* æŸ¥æ‰¾é«˜äº®èƒŒæ™¯é¢œè‰² */
        --highlight-text: black; /* æŸ¥æ‰¾é«˜äº®æ–‡æœ¬é¢œè‰² */
        --secondary-button-bg: #6c757d; /* æ¬¡è¦æŒ‰é’®èƒŒæ™¯é¢œè‰² */
        --secondary-button-hover-bg: #545b62; /* æ¬¡è¦æŒ‰é’®æ‚¬åœèƒŒæ™¯é¢œè‰² */
        --disabled-button-bg: #cccccc; /* ç¦ç”¨æŒ‰é’®èƒŒæ™¯é¢œè‰² */
        --disabled-button-text: #666666; /* ç¦ç”¨æŒ‰é’®æ–‡æœ¬é¢œè‰² */
        --textarea-bg: #fff; /* æ–‡æœ¬åŸŸèƒŒæ™¯é¢œè‰² */
        --output-bg: #f9f9f9; /* è¾“å‡ºåŒºåŸŸèƒŒæ™¯é¢œè‰² (æœªä½¿ç”¨ï¼ŒoutputTextDisplay ä½¿ç”¨ --output-editable-bg) */
        --output-border: #ddd; /* è¾“å‡ºåŒºåŸŸè¾¹æ¡†é¢œè‰² */
        --output-editable-bg: #ffffff; /* å¯ç¼–è¾‘è¾“å‡ºåŒºåŸŸèƒŒæ™¯é¢œè‰² */
        --font-family: "Microsoft YaHei UI", -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, Helvetica, Arial, sans-serif; /* å…¨å±€å­—ä½“ */

        /* æ»šåŠ¨æ¡æ ·å¼å˜é‡ */
        --scrollbar-width: 10px; /* æ»šåŠ¨æ¡å®½åº¦ */
        --scrollbar-border-radius: 5px; /* æ»šåŠ¨æ¡åœ†è§’ */
        --scrollbar-track-color: #e0e0e0; /* æ»šåŠ¨æ¡è½¨é“èƒŒæ™¯è‰² (æµ…è‰²ä¸»é¢˜) */
        --scrollbar-thumb-color: #a0a0a0; /* æ»šåŠ¨æ¡æ»‘å—é¢œè‰² (æµ…è‰²ä¸»é¢˜) */
        --scrollbar-thumb-hover-color: #707070; /* æ»šåŠ¨æ¡æ»‘å—æ‚¬åœé¢œè‰² (æµ…è‰²ä¸»é¢˜) */
      }

      /* æš—é»‘ä¸»é¢˜ä¸‹çš„ CSS å˜é‡è¦†ç›– */
      body.dark-theme {
        --bg-color: #252526;
        --text-color: #cccccc;
        --input-bg: #3c3c3c;
        --input-border: #555555;
        --button-bg: #007acc;
        --button-hover-bg: #005b99;
        --highlight-bg: #ffe700; /* æš—é»‘æ¨¡å¼ä¸‹çš„é«˜äº®èƒŒæ™¯ */
        --highlight-text: #1e1e1e; /* æš—é»‘æ¨¡å¼ä¸‹çš„é«˜äº®æ–‡æœ¬ */
        --secondary-button-bg: #5a6268;
        --secondary-button-hover-bg: #474c51;
        --textarea-bg: #2d2d2d;
        --output-bg: #1e1e1e;
        --output-border: #4a4a4a;
        --output-editable-bg: #2d2d2d;

        --scrollbar-track-color: #202020; /* æ»šåŠ¨æ¡è½¨é“èƒŒæ™¯è‰² (æš—é»‘ä¸»é¢˜) */
        --scrollbar-thumb-color: #555555; /* æ»šåŠ¨æ¡æ»‘å—é¢œè‰² (æš—é»‘ä¸»é¢˜) */
        --scrollbar-thumb-hover-color: #777777; /* æ»šåŠ¨æ¡æ»‘å—æ‚¬åœé¢œè‰² (æš—é»‘ä¸»é¢˜) */
      }

      /* body åŸºç¡€æ ·å¼ */
      body {
        font-family: var(--font-family); /* ä½¿ç”¨å®šä¹‰çš„å­—ä½“ */
        margin: 0; /* ç§»é™¤é»˜è®¤å¤–è¾¹è· */
        padding: 20px; /* å†…è¾¹è· */
        padding-top: 60px; /* ä¸ºå›ºå®šé¡¶æ ç•™å‡ºç©ºé—´ */
        background-color: var(--bg-color); /* ä½¿ç”¨å˜é‡å®šä¹‰èƒŒæ™¯è‰² */
        color: var(--text-color); /* ä½¿ç”¨å˜é‡å®šä¹‰æ–‡æœ¬é¢œè‰² */
        display: flex; /* ä½¿ç”¨ flex å¸ƒå±€ */
        flex-direction: column; /* å­å…ƒç´ å‚ç›´æ’åˆ— */
        gap: 15px; /* å­å…ƒç´ ä¹‹é—´çš„é—´éš™ */
        transition: background-color 0.3s, color 0.3s; /* èƒŒæ™¯å’Œé¢œè‰²å˜åŒ–çš„è¿‡æ¸¡æ•ˆæœ */
      }

      /* é¡¶éƒ¨å›ºå®šæ å®¹å™¨æ ·å¼ */
      .top-bar-container {
        position: fixed; /* å›ºå®šå®šä½ */
        top: 0; /* è·ç¦»é¡¶éƒ¨0 */
        left: 0; /* è·ç¦»å·¦ä¾§0 */
        width: 100%; /* å®½åº¦100% */
        padding: 10px 20px; /* å†…è¾¹è· */
        box-sizing: border-box; /* border å’Œ padding è®¡ç®—åœ¨å®½åº¦å†… */
        display: flex; /* flex å¸ƒå±€ */
        justify-content: flex-end; /* å†…å®¹å³å¯¹é½ */
        background-color: var(--bg-color); /* èƒŒæ™¯è‰² */
        z-index: 1000; /* å †å é¡ºåºï¼Œç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        border-bottom: 1px solid var(--input-border); /* åº•éƒ¨è¾¹æ¡† */
      }

      /* æ§åˆ¶ç»„æ ·å¼ï¼Œç”¨äºæ°´å¹³æ’åˆ—æ ‡ç­¾å’Œè¾“å…¥æ§ä»¶ */
      .control-group {
        display: flex; /* flex å¸ƒå±€ */
        align-items: flex-end; /* ä½¿å­é¡¹åº•éƒ¨å¯¹é½ï¼Œæœ‰åŠ©äºæŒ‰é’®å’Œè¾“å…¥æ¡†å¯¹é½ */
        gap: 10px; /* å­å…ƒç´ é—´éš™ */
        flex-wrap: wrap; /* å…è®¸å­å…ƒç´ æ¢è¡Œ */
      }
      /* ç¡®ä¿æ ‡ç­¾åœ¨å‚ç›´æ–¹å‘ä¸Šä¸è¾“å…¥æ¡†çš„åŸºçº¿æˆ–ä¸­å¿ƒå¯¹é½ï¼Œå¦‚æœè¾“å…¥æ¡†å’ŒæŒ‰é’®åº•éƒ¨å¯¹é½äº†ï¼Œæ ‡ç­¾å¯èƒ½éœ€è¦è°ƒæ•´ */
      .control-group > .input-label-group > label {
        margin-bottom: 4px; /* å¾®è°ƒæ ‡ç­¾ä½ç½® */
      }

      /* æ§åˆ¶ç»„å†…æ ‡ç­¾å’Œè¾“å…¥æ ‡ç­¾ç»„å†…æ ‡ç­¾çš„æ ·å¼ */
      .control-group label,
      .input-label-group > label {
        white-space: nowrap; /* é˜²æ­¢æ ‡ç­¾å†…æ–‡å­—æ¢è¡Œ */
        font-size: 0.9em; /* å­—ä½“å¤§å° */
        color: var(--text-color); /* æ–‡æœ¬é¢œè‰² */
        opacity: 0.9; /* é€æ˜åº¦ */
        margin-bottom: 2px; /* åº•éƒ¨å¤–è¾¹è· */
      }

      /* æ–‡æœ¬è¾“å…¥æ¡†ã€æ–‡æœ¬åŸŸå’Œä¸‹æ‹‰é€‰æ‹©æ¡†çš„é€šç”¨æ ·å¼ */
      input[type="text"],
      textarea,
      select {
        padding: 8px 10px; /* å†…è¾¹è· */
        border: 1px solid var(--input-border); /* è¾¹æ¡† */
        border-radius: 4px; /* åœ†è§’ */
        background-color: var(--input-bg); /* èƒŒæ™¯è‰² */
        color: var(--text-color); /* æ–‡æœ¬é¢œè‰² */
        font-size: 14px; /* å­—ä½“å¤§å° */
        font-family: var(--font-family); /* å­—ä½“ */
      }

      /* æ–‡æœ¬è¾“å…¥æ¡†å’Œä¸‹æ‹‰é€‰æ‹©æ¡†çš„ç‰¹å®šæ ·å¼ï¼Œä½¿å…¶å¯ä¼¸ç¼© */
      input[type="text"],
      select {
        flex-grow: 1; /* å æ®å‰©ä½™ç©ºé—´ */
        min-width: 150px; /* æœ€å°å®½åº¦ */
      }

      /* è¾“å…¥æ¡†ä¸æŒ‰é’®ç»„åˆçš„åŒ…è£¹å®¹å™¨æ ·å¼ */
      .input-with-button-wrapper {
        display: flex; /* flex å¸ƒå±€ */
        flex-grow: 1; /* å æ®çˆ¶å®¹å™¨çš„å‰©ä½™ç©ºé—´ */
      }

      /* è¾“å…¥æ¡†ä¸æŒ‰é’®ç»„åˆä¸­è¾“å…¥æ¡†/é€‰æ‹©æ¡†çš„æ ·å¼ */
      .input-with-button-wrapper input[type="text"],
      .input-with-button-wrapper select {
        border-top-right-radius: 0; /* ç§»é™¤å³ä¸Šåœ†è§’ */
        border-bottom-right-radius: 0; /* ç§»é™¤å³ä¸‹åœ†è§’ */
        flex-grow: 1; /* å æ®åŒ…è£¹å®¹å™¨çš„å‰©ä½™ç©ºé—´ */
      }

      /* è¾“å…¥æ¡†ä¸æŒ‰é’®ç»„åˆä¸­æŒ‰é’®çš„æ ·å¼ */
      .input-with-button-wrapper button {
        border-top-left-radius: 0; /* ç§»é™¤å·¦ä¸Šåœ†è§’ */
        border-bottom-left-radius: 0; /* ç§»é™¤å·¦ä¸‹åœ†è§’ */
      }

      /* æŒ‰é’®é€šç”¨æ ·å¼ */
      button {
        padding: 8px 15px; /* å†…è¾¹è· */
        border: none; /* æ— è¾¹æ¡† */
        border-radius: 4px; /* åœ†è§’ */
        background-color: var(--button-bg); /* èƒŒæ™¯è‰² */
        color: var(--button-text); /* æ–‡æœ¬é¢œè‰² */
        cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆæ ·å¼ */
        font-size: 14px; /* å­—ä½“å¤§å° */
        font-family: var(--font-family); /* å­—ä½“ */
        transition: background-color 0.2s; /* èƒŒæ™¯è‰²è¿‡æ¸¡æ•ˆæœ */
        white-space: nowrap; /* é˜²æ­¢æŒ‰é’®å†…æ–‡å­—æ¢è¡Œ */
        height: 36px; /* å›ºå®šé«˜åº¦ï¼Œä¸è¾“å…¥æ¡†å¯¹é½ */
        box-sizing: border-box; /* padding å’Œ border è®¡ç®—åœ¨é«˜åº¦å†… */
      }

      /* æŒ‰é’®æ‚¬åœæ ·å¼ */
      button:hover {
        background-color: var(--button-hover-bg); /* æ‚¬åœèƒŒæ™¯è‰² */
      }

      /* æ¬¡è¦æŒ‰é’®æ ·å¼ */
      button.secondary {
        background-color: var(--secondary-button-bg); /* æ¬¡è¦æŒ‰é’®èƒŒæ™¯è‰² */
      }

      /* æ¬¡è¦æŒ‰é’®æ‚¬åœæ ·å¼ */
      button.secondary:hover {
        background-color: var(
          --secondary-button-hover-bg
        ); /* æ¬¡è¦æŒ‰é’®æ‚¬åœèƒŒæ™¯è‰² */
      }

      /* ç¦ç”¨æŒ‰é’®æ ·å¼ */
      button:disabled {
        background-color: var(--disabled-button-bg); /* ç¦ç”¨èƒŒæ™¯è‰² */
        color: var(--disabled-button-text); /* ç¦ç”¨æ–‡æœ¬é¢œè‰² */
        cursor: not-allowed; /* ç¦ç”¨é¼ æ ‡æŒ‡é’ˆ */
      }

      /* åŸæ–‡è¾“å…¥æ–‡æœ¬åŸŸæ ·å¼ */
      #inputText {
        width: 100%; /* å®½åº¦100% */
        min-height: 150px; /* æœ€å°é«˜åº¦ */
        resize: vertical; /* å…è®¸å‚ç›´æ–¹å‘è°ƒæ•´å¤§å° */
        box-sizing: border-box; /* padding å’Œ border è®¡ç®—åœ¨å®½åº¦å†… */
        background-color: var(--textarea-bg); /* èƒŒæ™¯è‰² */
      }

      /* å¤„ç†åæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
      #outputTextDisplay {
        width: 100%;
        /* min-height: 250px; æ”¹ä¸ºå›ºå®šé«˜åº¦ */
        height: 400px; /* è®¾ç½®ä¸€ä¸ªå›ºå®šé«˜åº¦ï¼Œä¾‹å¦‚ 400pxï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ */
        border: 1px solid var(--output-border);
        border-radius: 4px;
        padding: 10px;
        /* ä¸ºè‡ªå®šä¹‰æ»šåŠ¨æ¡ç•™å‡ºç©ºé—´ï¼Œé¿å…å†…å®¹è¢«æœ€å³ä¾§çš„æ»šåŠ¨æ¡é®æŒ¡ */
        /* å¦‚æœæ»šåŠ¨æ¡æ˜¯æµ®åŠ¨(overlay)ç±»å‹ï¼Œåˆ™æ­¤paddingå¯èƒ½ä¸éœ€è¦æˆ–éœ€è¦è°ƒæ•´ */
        padding-right: calc(var(--scrollbar-width) + 4px);
        overflow-y: auto; /* å†…å®¹è¶…å‡ºæ—¶æ˜¾ç¤ºå‚ç›´æ»šåŠ¨æ¡ */
        background-color: var(--output-editable-bg);
        white-space: pre-wrap; /* ä¿ç•™ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ­£å¸¸æ¢è¡Œ */
        word-wrap: break-word; /* å…è®¸åœ¨é•¿å•è¯æˆ– URL åœ°å€å†…éƒ¨è¿›è¡Œæ¢è¡Œ */
        box-sizing: border-box;
        font-size: 16px;
        line-height: 1.7;
        color: var(--text-color);
        font-family: var(--font-family);
        /* Firefox æ»šåŠ¨æ¡æ ·å¼ */
        scrollbar-width: thin;
        scrollbar-color: var(--scrollbar-thumb-color)
          var(--scrollbar-track-color);
      }

      /* å¤„ç†åæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸè·å–ç„¦ç‚¹æ—¶çš„æ ·å¼ */
      #outputTextDisplay:focus {
        outline: 2px solid var(--button-bg); /* ç„¦ç‚¹è½®å»“ */
        border-color: var(--button-bg); /* è¾¹æ¡†é¢œè‰²ä¸æŒ‰é’®ä¸€è‡´ */
      }

      /* Webkit (Chrome, Safari, Edge) æµè§ˆå™¨è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ for #outputTextDisplay */
      #outputTextDisplay::-webkit-scrollbar {
        width: var(--scrollbar-width);
      }

      #outputTextDisplay::-webkit-scrollbar-track {
        background: var(--scrollbar-track-color);
        border-radius: var(--scrollbar-border-radius);
        /* å¯ä»¥ç»™è½¨é“æ·»åŠ ä¸€äº›è¾¹è·ï¼Œä½¿å…¶ä¸ç´§è´´è¾¹ç¼˜ */
        margin: 2px 0;
      }

      #outputTextDisplay::-webkit-scrollbar-thumb {
        background-color: var(--scrollbar-thumb-color);
        border-radius: var(--scrollbar-border-radius);
        /* ç»™æ»‘å—æ·»åŠ è¾¹æ¡†ï¼Œä½¿å…¶çœ‹èµ·æ¥åœ¨è½¨é“å†…éƒ¨ï¼Œå¢åŠ å±‚æ¬¡æ„Ÿ */
        border: 2px solid var(--scrollbar-track-color);
      }

      #outputTextDisplay::-webkit-scrollbar-thumb:hover {
        background-color: var(--scrollbar-thumb-hover-color);
      }

      /* æ–‡æœ¬é«˜äº®æ ·å¼ */
      .highlight {
        background-color: var(--highlight-bg); /* é«˜äº®èƒŒæ™¯è‰² */
        color: var(--highlight-text); /* é«˜äº®æ–‡æœ¬é¢œè‰² */
        font-weight: bold; /* å­—ä½“åŠ ç²— */
        border-radius: 3px; /* ç¨å¾®å¢åŠ åœ†è§’ */
        padding: 1px 3px; /* å¢åŠ å¾®å°çš„å†…è¾¹è·ä½¿é«˜äº®æ›´é¥±æ»¡ */
        /* box-shadow: 0 0 5px var(--highlight-bg); /* å¯é€‰ï¼šæ·»åŠ è½»å¾®è¾‰å…‰æ•ˆæœ */
        /* ä¸ºäº†æ¨¡ä»¿VSCodeçš„é£æ ¼ï¼Œé€šå¸¸æ˜¯é«˜å¯¹æ¯”åº¦çš„èƒŒæ™¯è‰²ï¼Œè€Œä¸æ˜¯è¿‡å¤šçš„è£…é¥° */
        outline: 1px solid rgba(0, 0, 0, 0.1); /* å¯é€‰ï¼šç»™é«˜äº®åŒºåŸŸä¸€ä¸ªéå¸¸ç»†å¾®çš„è½®å»“ */
      }

      /* è¾“å…¥æ¡†å’Œæ ‡ç­¾ç»„åˆçš„æ ·å¼ï¼ˆæ ‡ç­¾åœ¨è¾“å…¥æ¡†ä¸Šæ–¹ï¼‰ */
      .input-label-group {
        display: flex; /* flex å¸ƒå±€ */
        flex-direction: column; /* å­å…ƒç´ å‚ç›´æ’åˆ— */
        gap: 5px; /* å­å…ƒç´ é—´éš™ */
        flex-grow: 1; /* å æ®çˆ¶å®¹å™¨çš„å‰©ä½™ç©ºé—´ */
      }

      /* å æ»¡å…¨å®½çš„ç»„ï¼Œç”¨äºæ–‡æœ¬åŸŸç­‰ */
      .full-width-group {
        display: flex; /* flex å¸ƒå±€ */
        flex-direction: column; /* å­å…ƒç´ å‚ç›´æ’åˆ— */
        width: 100%; /* å®½åº¦100% */
        gap: 5px; /* å­å…ƒç´ é—´éš™ */
      }

      /* æ ‡ç­¾ä¸æŒ‰é’®æ°´å¹³æ’åˆ—çš„å®¹å™¨ */
      .label-with-button {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 5px;
      }

      .label-with-button button {
        margin-left: 5px; /* ç»Ÿä¸€å·¦è¾¹è·ï¼Œç¬¬ä¸€ä¸ªæŒ‰é’®é™¤å¤– */
        height: 28px; /* ä¿æŒè¾ƒå°çš„é«˜åº¦ */
        padding: 4px 10px; /* è°ƒæ•´å†…è¾¹è·ä½¿ç®­å¤´æŒ‰é’®æ›´ç´§å‡‘ */
        font-size: 14px; /* ç¡®ä¿å­—ä½“å¤§å°ä¸€è‡´ */
      }
      .label-with-button button:first-child {
        margin-left: 0; /* ç§»é™¤ç¬¬ä¸€ä¸ªæŒ‰é’®çš„å·¦è¾¹è· */
      }

      /* ä¸ºå¯¼èˆªæŒ‰é’®ç‰¹åˆ«è®¾ç½® */
      #prevMatchBtn,
      #nextMatchBtn {
        min-width: 30px; /* ç»™ç®­å¤´æŒ‰é’®ä¸€ä¸ªæœ€å°å®½åº¦ */
      }

      /* æ–°å¢ï¼šå¤„ç†åæ–‡æœ¬åŒºåŸŸä¸è¿·ä½ åœ°å›¾çš„åŒ…è£¹å®¹å™¨ */
      .output-and-minimap-container {
        display: flex;
        align-items: flex-start; /* é¡¶ç«¯å¯¹é½ */
      }

      /* æ–°å¢ï¼šoutputTextDisplay çš„ç›´æ¥åŒ…è£¹å™¨ï¼Œç”¨äºå®šä½å…¶å†…éƒ¨çš„å›åˆ°é¡¶éƒ¨æŒ‰é’® */
      #outputTextDisplayWrapper {
        position: relative;
        flex-grow: 1; /* ä½¿ outputTextDisplay å æ®ä¸»è¦ç©ºé—´ */
      }

      /* ç¡®ä¿ outputTextDisplay æœ‰å›ºå®šçš„é«˜åº¦ï¼Œå¹¶ä¸”å…¶å†…éƒ¨æ»šåŠ¨æ¡æ­£å¸¸å·¥ä½œ */
      #outputTextDisplay {
        /* width: 100%; */ /* è¿™ç”± flex-grow æ§åˆ¶ */
        height: 400px; /* ä¿æŒä¹‹å‰è®¾å®šçš„å›ºå®šé«˜åº¦ */
        /* å…¶ä»–ç°æœ‰ #outputTextDisplay æ ·å¼ä¿æŒä¸å˜ */
      }

      /* æ–°å¢ï¼šè¿·ä½ åœ°å›¾å®¹å™¨æ ·å¼ */
      #minimapContainer {
        width: 18px; /* è¿·ä½ åœ°å›¾çš„å®½åº¦ */ /* TODO */
        height: 400px; /* ä¸ outputTextDisplay é«˜åº¦ä¸€è‡´ */
        margin-left: 5px; /* ä¸æ–‡æœ¬åŒºåŸŸçš„é—´è· */
        background-color: var(--input-bg); /* ä½¿ç”¨è¾“å…¥æ¡†èƒŒæ™¯è‰²æˆ–ç¨æš—çš„è½¨é“è‰² */
        border: 1px solid var(--input-border);
        position: relative; /* ç”¨äºç»å¯¹å®šä½å†…éƒ¨çš„æ ‡è®° */
        border-radius: 3px;
        overflow: hidden; /* é˜²æ­¢æ ‡è®°æº¢å‡º */
        box-sizing: border-box;
      }

      /* æ–°å¢ï¼šè¿·ä½ åœ°å›¾æ ‡è®°æ ·å¼ */
      .minimap-mark {
        position: absolute;
        left: 0;
        width: 100%;
        height: 3px; /* æ ‡è®°çš„é«˜åº¦ï¼Œç¡®ä¿å¯ç‚¹å‡» */
        background-color: var(--highlight-bg); /* ä½¿ç”¨é«˜äº®èƒŒæ™¯è‰² */
        opacity: 0.6;
        cursor: pointer;
        transition: opacity 0.2s, background-color 0.2s;
        z-index: 1; /* ç¡®ä¿åœ¨å®¹å™¨èƒŒæ™¯ä¹‹ä¸Š */
      }

      .minimap-mark:hover {
        opacity: 0.9;
        background-color: var(--button-hover-bg); /* æ‚¬åœæ—¶æ›´æ˜æ˜¾ */
      }
      .minimap-mark.selected {
        background-color: var(
          --button-hover-bg
        ); /* ä½¿ç”¨æ›´é²œæ˜çš„é¢œè‰²ï¼Œä¾‹å¦‚æŒ‰é’®æ‚¬åœè‰² */
        opacity: 1;
        /* å¯ä»¥è€ƒè™‘æ·»åŠ ä¸€ä¸ªç»†è¾¹æ¡†ä½¿å…¶æ›´çªå‡º */
        border: 1px solid var(--text-color);
      }

      /* æ–°å¢ï¼šä¸“ç”¨äº outputTextDisplay çš„å›åˆ°é¡¶éƒ¨æŒ‰é’® */
      #outputScrollToTopBtn {
        position: absolute;
        bottom: 10px; /* ç•¥å¾®è°ƒæ•´ä½ç½® */
        right: calc(var(--scrollbar-width) + 10px); /* ç•¥å¾®è°ƒæ•´ä½ç½® */
        width: 28px; /* ç¼©å°å®½åº¦ */
        height: 28px; /* ç¼©å°é«˜åº¦ */
        border-radius: 50%;
        background-color: var(--button-bg);
        color: var(--button-text);
        font-size: 14px; /* è°ƒæ•´ç®­å¤´å¤§å° */
        border: none;
        cursor: pointer;
        display: none; /* åˆå§‹éšè— */
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2); /* è°ƒæ•´é˜´å½± */
        z-index: 1001;
        opacity: 1; /* æ”¹ä¸ºå®Œå…¨ä¸é€æ˜ */
        transition: background-color 0.2s, bottom 0.3s; /* ç§»é™¤ opacity è¿‡æ¸¡ */
        /* ä½¿ç”¨ Flexbox ä½¿ç®­å¤´å±…ä¸­ */
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0; /* ç§»é™¤å¯èƒ½çš„é»˜è®¤å†…è¾¹è· */
      }

      #outputScrollToTopBtn:hover {
        background-color: var(--button-hover-bg);
        /* opacity: 1; /* ä¸å†éœ€è¦ï¼Œå› ä¸ºåŸºç¡€ opacity å°±æ˜¯ 1 */
      }

      /* æ–°å¢ï¼šç”¨äºä¸´æ—¶é«˜äº®è·³è½¬åˆ°çš„åŒ¹é…é¡¹ */
      .highlight.scrolled-to {
        outline: 2px solid var(--button-hover-bg); /* ä½¿ç”¨æŒ‰é’®æ‚¬åœé¢œè‰²ä½œä¸ºè½®å»“ */
        box-shadow: 0 0 8px var(--button-hover-bg); /* æ·»åŠ è¾‰å…‰æ•ˆæœ */
        transition: outline 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
      }

      /* å›åˆ°é¡¶éƒ¨æŒ‰é’®æ ·å¼ */
      #scrollToTopBtn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: var(--button-bg);
        color: var(--button-text);
        font-size: 20px;
        border: none;
        cursor: pointer;
        display: none; /* åˆå§‹çŠ¶æ€ä¸æ˜¾ç¤º */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        opacity: 0.8;
        transition: opacity 0.3s, background-color 0.2s;
      }

      #scrollToTopBtn:hover {
        background-color: var(--button-hover-bg);
        opacity: 1;
      }
    </style>
  </head>

  <body>
    <!-- é¡¶éƒ¨æ ï¼ŒåŒ…å«ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
    <div class="top-bar-container">
      <button id="themeToggleBtn" aria-label="åˆ‡æ¢æ˜æš—ä¸»é¢˜">ğŸŒ™/â˜€ï¸</button>
      <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
    </div>

    <!-- å­˜æ¡£åç§°è¾“å…¥å’Œä¿å­˜æŒ‰é’® -->
    <div class="control-group">
      <div class="input-label-group">
        <label for="regexNameInput">å­˜æ¡£åç§° (å¯é€‰):</label>
        <input
          type="text"
          id="regexNameInput"
          placeholder="ä¸ºæ­¤æ­£åˆ™è¡¨è¾¾å¼å‘½å"
        />
        <!-- å­˜æ¡£åç§°è¾“å…¥æ¡† -->
      </div>
      <button id="saveRegexBtn">å­˜æ¡£æ­¤è¡¨è¾¾å¼</button>
      <!-- ä¿å­˜è¡¨è¾¾å¼æŒ‰é’® -->
    </div>
    <!-- é€‰æ‹©å·²å­˜æ¡£çš„æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹ï¼Œä»¥åŠåˆ é™¤æŒ‰é’® -->
    <div class="control-group">
      <div class="input-label-group">
        <label for="savedRegexSelect">é€‰æ‹©å·²å­˜æ¡£ æ­£åˆ™/æ›¿æ¢:</label>
        <div class="input-with-button-wrapper">
          <select id="savedRegexSelect"></select>
          <!-- å·²å­˜æ¡£å†…å®¹ä¸‹æ‹‰é€‰æ‹©æ¡† -->
          <button id="deleteRegexBtn" class="secondary" title="åˆ é™¤é€‰ä¸­çš„å­˜æ¡£">
            åˆ é™¤é€‰ä¸­
          </button>
          <!-- åˆ é™¤é€‰ä¸­å­˜æ¡£æŒ‰é’® -->
        </div>
      </div>
    </div>

    <!-- æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥å’ŒæŸ¥æ‰¾æŒ‰é’® -->
    <div class="control-group">
      <div class="input-label-group">
        <label for="regexInput">æ­£åˆ™è¡¨è¾¾å¼:</label>
        <div class="input-with-button-wrapper">
          <input
            type="text"
            id="regexInput"
            placeholder="è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æˆ–ä»ä¸Šæ–¹é€‰æ‹©"
          />
          <!-- æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡† -->
          <button id="findBtn">æŸ¥æ‰¾</button>
          <!-- æŸ¥æ‰¾æŒ‰é’® -->
        </div>
      </div>
    </div>

    <!-- æ›¿æ¢æ–‡æœ¬è¾“å…¥å’Œæ›¿æ¢æŒ‰é’® -->
    <div class="control-group">
      <div class="input-label-group">
        <label for="replaceInput">æ›¿æ¢ä¸º:</label>
        <input
          type="text"
          id="replaceInput"
          placeholder="è¾“å…¥æ›¿æ¢æ–‡æœ¬æˆ–ä»ä¸Šæ–¹é€‰æ‹©"
        />
        <!-- æ›¿æ¢æ–‡æœ¬è¾“å…¥æ¡† -->
      </div>
      <button id="replaceNextBtn" disabled>æ›¿æ¢ä¸‹ä¸€ä¸ª</button>
      <!-- æ›¿æ¢ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹æŒ‰é’®ï¼Œé»˜è®¤ç¦ç”¨ -->
      <button id="replaceAllBtn" disabled>å…¨éƒ¨æ›¿æ¢</button>
      <!-- å…¨éƒ¨æ›¿æ¢æŒ‰é’®ï¼Œé»˜è®¤ç¦ç”¨ -->
    </div>

    <!-- åŸæ–‡è¾“å…¥åŒºåŸŸ -->
    <div class="full-width-group">
      <label for="inputText">ç²˜è´´åŸæ–‡ (æºæ–‡æœ¬):</label>
      <textarea id="inputText" placeholder="åœ¨æ­¤ç²˜è´´å¤§ç¯‡å¹…æ–‡ç« "></textarea>
      <!-- åŸæ–‡è¾“å…¥æ–‡æœ¬åŸŸ -->
    </div>
    <!-- ç²˜è´´æŒ‰é’® -->
    <div class="control-group">
      <button id="pasteBtn">ç²˜è´´å‰ªè´´æ¿å†…å®¹åˆ°åŸæ–‡</button>
      <!-- ç²˜è´´æŒ‰é’® -->
    </div>

    <!-- å¤„ç†åæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ -->
    <div class="full-width-group">
      <div class="label-with-button">
        <label for="outputTextDisplay">å¤„ç†åæ–‡æœ¬ (å¯ç¼–è¾‘):</label>
        <div>
          <!-- æ–°å¢ä¸€ä¸ª div åŒ…è£¹æŒ‰é’®ï¼Œæ–¹ä¾¿å¯¹é½ -->
          <button
            id="prevMatchBtn"
            class="secondary"
            title="ä¸Šä¸€ä¸ªåŒ¹é…"
            disabled
          >
            â†‘
          </button>
          <button
            id="nextMatchBtn"
            class="secondary"
            title="ä¸‹ä¸€ä¸ªåŒ¹é…"
            disabled
          >
            â†“
          </button>
          <button id="copyOutputBtn" class="secondary" title="å¤åˆ¶å¤„ç†åæ–‡æœ¬">
            å¤åˆ¶
          </button>
        </div>
      </div>
      <div class="output-and-minimap-container">
        <div id="outputTextDisplayWrapper">
          <div
            id="outputTextDisplay"
            contenteditable="true"
            spellcheck="false"
            aria-live="polite"
          >
            å¤„ç†åçš„æ–‡æœ¬å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
          </div>
          <button
            id="outputScrollToTopBtn"
            aria-label="æ»šåŠ¨åˆ°è¾“å‡ºåŒºé¡¶éƒ¨"
            title="æ»šåŠ¨åˆ°è¾“å‡ºåŒºé¡¶éƒ¨"
          >
            â†‘
          </button>
        </div>
        <div id="minimapContainer">
          <!-- è¿·ä½ åœ°å›¾æ ‡è®°å°†ç”± JavaScript åŠ¨æ€æ·»åŠ  -->
        </div>
      </div>
    </div>

    <!-- å¤åˆ¶å¤„ç†åæ–‡æœ¬æŒ‰é’® -->
    <div class="control-group">
      <button id="copyModifiedBtn" disabled>å¤åˆ¶å¤„ç†åæ–‡æœ¬</button>
      <!-- å¤åˆ¶æŒ‰é’®ï¼Œé»˜è®¤ç¦ç”¨ -->
    </div>

    <button id="scrollToTopBtn" aria-label="å›åˆ°é¡¶éƒ¨" title="å›åˆ°é¡¶éƒ¨">
      â†‘
    </button>

    <script>
      // --- DOM å…ƒç´ è·å– ---
      // æ­¤éƒ¨åˆ†ä»£ç è·å– HTML é¡µé¢ä¸­å„ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œä»¥ä¾¿åç»­é€šè¿‡ JavaScript æ“ä½œå®ƒä»¬ã€‚
      const regexNameInput = document.getElementById("regexNameInput"); // å­˜æ¡£åç§°è¾“å…¥æ¡†
      const saveRegexBtn = document.getElementById("saveRegexBtn"); // ä¿å­˜å­˜æ¡£æŒ‰é’®
      const savedRegexSelect = document.getElementById("savedRegexSelect"); // å·²å­˜æ¡£æ­£åˆ™è¡¨è¾¾å¼ä¸‹æ‹‰åˆ—è¡¨
      const deleteRegexBtn = document.getElementById("deleteRegexBtn"); // åˆ é™¤å­˜æ¡£æŒ‰é’®
      const regexInput = document.getElementById("regexInput"); // æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†
      const findBtn = document.getElementById("findBtn"); // æŸ¥æ‰¾æŒ‰é’®
      const replaceInput = document.getElementById("replaceInput"); // æ›¿æ¢æ–‡æœ¬è¾“å…¥æ¡†
      const replaceNextBtn = document.getElementById("replaceNextBtn"); // æ›¿æ¢ä¸‹ä¸€ä¸ªæŒ‰é’®
      const replaceAllBtn = document.getElementById("replaceAllBtn"); // å…¨éƒ¨æ›¿æ¢æŒ‰é’®
      const inputText = document.getElementById("inputText"); // åŸæ–‡è¾“å…¥æ–‡æœ¬åŸŸ
      const pasteBtn = document.getElementById("pasteBtn"); // ç²˜è´´æŒ‰é’®
      const outputTextDisplay = document.getElementById("outputTextDisplay"); // å¤„ç†åæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ
      const copyModifiedBtn = document.getElementById("copyModifiedBtn"); // å¤åˆ¶å¤„ç†åæ–‡æœ¬æŒ‰é’®
      const themeToggleBtn = document.getElementById("themeToggleBtn"); // ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      const copyOutputBtn = document.getElementById("copyOutputBtn"); // æ ‡ç­¾æ—çš„å¤åˆ¶æŒ‰é’®
      const minimapContainer = document.getElementById("minimapContainer");
      const outputScrollToTopBtn = document.getElementById(
        "outputScrollToTopBtn"
      );
      const prevMatchBtn = document.getElementById("prevMatchBtn");
      const nextMatchBtn = document.getElementById("nextMatchBtn");

      // --- å…¨å±€å˜é‡ ---
      let currentMatches = []; // å­˜å‚¨å½“å‰æŸ¥æ‰¾åˆ°çš„åŒ¹é…é¡¹æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å« {index, text, length}
      let textForOutputProcessing = ""; // å­˜å‚¨å½“å‰ç”¨äºæŸ¥æ‰¾å’Œæ›¿æ¢æ“ä½œçš„æ–‡æœ¬åŸºç¡€ï¼Œé€šå¸¸ä¸ outputTextDisplay çš„ innerText åŒæ­¥æˆ–æ¥è‡ª inputText
      const SAVED_REGEX_LOCALSTORAGE_KEY =
        "textProcessorSavedRegexesAndReplacements"; // ç”¨äº localStorage å­˜å‚¨å­˜æ¡£æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹çš„é”®å
      let currentMatchIndex = -1; // å½“å‰é€šè¿‡å¯¼èˆªé€‰ä¸­çš„åŒ¹é…é¡¹ç´¢å¼•
      // --- æ­£åˆ™è¡¨è¾¾å¼åŠæ›¿æ¢å¼å­˜æ¡£é€»è¾‘ ---

      /**
       * @function loadSavedRegexes
       * @description ä» localStorage åŠ è½½å·²å­˜æ¡£çš„æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹ï¼Œå¹¶å¡«å……åˆ°ä¸‹æ‹‰é€‰æ‹©æ¡†ä¸­ã€‚
       */
      function loadSavedRegexes() {
        const savedItems = JSON.parse(
          localStorage.getItem(SAVED_REGEX_LOCALSTORAGE_KEY) || "[]"
        ); // ä» localStorage è¯»å–å­˜æ¡£ï¼Œè‹¥æ— åˆ™è¿”å›ç©ºæ•°ç»„
        savedRegexSelect.innerHTML =
          '<option value="">--é€‰æ‹©å·²å­˜æ¡£æˆ–æ‰‹åŠ¨è¾“å…¥--</option>'; // è®¾ç½®ä¸‹æ‹‰æ¡†çš„é»˜è®¤æç¤ºé€‰é¡¹
        savedItems.forEach((item) => {
          //éå†æ¯ä¸ªå­˜æ¡£é¡¹
          const option = document.createElement("option"); // åˆ›å»ºæ–°çš„ option å…ƒç´ 
          option.value = item.pattern || ""; // è®¾ç½® option çš„ value ä¸ºå­˜æ¡£çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚æœæ­£åˆ™ä¸ºç©ºåˆ™è®¾ä¸ºç©ºå­—ç¬¦ä¸²
          // æ„å»º option æ˜¾ç¤ºçš„æ–‡æœ¬ï¼ŒåŒ…å«åç§°ã€æ­£åˆ™è¡¨è¾¾å¼é¢„è§ˆå’Œæ›¿æ¢å†…å®¹é¢„è§ˆ
          let displayText = item.name; // å­˜æ¡£åç§°
          if (item.pattern) {
            // å¦‚æœæœ‰æ­£åˆ™è¡¨è¾¾å¼
            displayText += ` (æ­£åˆ™: ${item.pattern.substring(0, 20)}${
              item.pattern.length > 20 ? "..." : ""
            })`; // é™„åŠ æ­£åˆ™é¢„è§ˆ
          }
          if (
            typeof item.replacement === "string" &&
            item.replacement.length > 0
          ) {
            // å¦‚æœæœ‰æ›¿æ¢å†…å®¹ä¸”ä¸ä¸ºç©º
            displayText += ` (æ›¿æ¢: ${item.replacement.substring(0, 15)}${
              item.replacement.length > 15 ? "..." : ""
            })`; // é™„åŠ æ›¿æ¢å†…å®¹é¢„è§ˆ
          } else if (typeof item.replacement === "string") {
            // å¦‚æœæ›¿æ¢å†…å®¹æ˜¯ç©ºå­—ç¬¦ä¸²
            displayText += ` (æ›¿æ¢: ç©º)`; // æ ‡è®°æ›¿æ¢ä¸ºç©º
          }
          option.textContent = displayText; // è®¾ç½® option çš„æ˜¾ç¤ºæ–‡æœ¬
          option.dataset.name = item.name; // å°†å­˜æ¡£åç§°å­˜å‚¨åœ¨ dataset ä¸­
          option.dataset.replacement =
            item.replacement !== undefined ? item.replacement : ""; // å°†æ›¿æ¢å†…å®¹å­˜å‚¨åœ¨ dataset ä¸­ï¼Œè‹¥æœªå®šä¹‰åˆ™ä¸ºç©ºå­—ç¬¦ä¸²

          savedRegexSelect.appendChild(option); // å°†åˆ›å»ºçš„ option æ·»åŠ åˆ°ä¸‹æ‹‰æ¡†
        });
      }

      /**
       * @event saveRegexBtn 'click'
       * @description å¤„ç†â€œå­˜æ¡£æ­¤è¡¨è¾¾å¼â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              æ”¶é›†å­˜æ¡£åç§°ã€æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ° localStorageã€‚
       *              å¦‚æœå­˜æ¡£åç§°å·²å­˜åœ¨ï¼Œåˆ™æç¤ºç”¨æˆ·æ˜¯å¦è¦†ç›–ã€‚
       */
      saveRegexBtn.addEventListener("click", () => {
        const name = regexNameInput.value.trim(); // è·å–å¹¶å»é™¤å­˜æ¡£åç§°ä¸¤ç«¯ç©ºæ ¼
        const pattern = regexInput.value.trim(); // è·å–å¹¶å»é™¤æ­£åˆ™è¡¨è¾¾å¼ä¸¤ç«¯ç©ºæ ¼
        const replacement = replaceInput.value; // è·å–æ›¿æ¢å†…å®¹ï¼ˆå…è®¸ä¸¤ç«¯æœ‰ç©ºæ ¼ï¼Œå› ä¸ºæ›¿æ¢å†…å®¹å¯èƒ½éœ€è¦ï¼‰

        // æ ¡éªŒï¼šåç§°ã€æ­£åˆ™ã€æ›¿æ¢è‡³å°‘è¦æœ‰ä¸€ä¸ªï¼Œä¸”åç§°ä¸èƒ½ä¸ºç©º
        if (!pattern && !replacement && !name) {
          // å¦‚æœä¸‰è€…éƒ½ä¸ºç©º
          alert("è¯·è¾“å…¥å­˜æ¡£åç§°ã€æ­£åˆ™è¡¨è¾¾å¼æˆ–æ›¿æ¢å†…å®¹ä¸­çš„è‡³å°‘ä¸€é¡¹ã€‚");
          return;
        }
        if (!name) {
          // å¦‚æœåç§°ä¸ºç©º
          alert("å­˜æ¡£åç§°ä¸èƒ½ä¸ºç©º!");
          return;
        }
        // å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸ºç©ºä½†æ›¿æ¢å†…å®¹ä¸ä¸ºç©ºï¼Œåˆ™å‘ç”¨æˆ·ç¡®è®¤
        if (!pattern && replacement) {
          if (
            !confirm(`æ­£åˆ™è¡¨è¾¾å¼ä¸ºç©ºï¼Œç¡®å®šåªå­˜æ¡£åç§° "${name}" å’Œæ›¿æ¢å†…å®¹å—?`)
          ) {
            return; // ç”¨æˆ·å–æ¶ˆåˆ™ä¸ç»§ç»­
          }
        }

        let savedItems = JSON.parse(
          localStorage.getItem(SAVED_REGEX_LOCALSTORAGE_KEY) || "[]"
        ); // è·å–å·²æœ‰çš„å­˜æ¡£
        const existingIndex = savedItems.findIndex(
          (item) => item.name === name
        ); // æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨åŒåå­˜æ¡£

        if (existingIndex > -1) {
          // å¦‚æœå­˜åœ¨åŒåå­˜æ¡£
          if (
            confirm(
              `å·²å­˜åœ¨åä¸º "${name}" çš„å­˜æ¡£ã€‚è¦è¦†ç›–å®ƒçš„æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹å—?`
            )
          ) {
            // è¯¢é—®ç”¨æˆ·æ˜¯å¦è¦†ç›–
            savedItems[existingIndex].pattern = pattern; // è¦†ç›–æ­£åˆ™è¡¨è¾¾å¼
            savedItems[existingIndex].replacement = replacement; // è¦†ç›–æ›¿æ¢å†…å®¹
          } else {
            return; // ç”¨æˆ·å–æ¶ˆè¦†ç›–åˆ™ä¸ç»§ç»­
          }
        } else {
          // å¦‚æœä¸å­˜åœ¨åŒåå­˜æ¡£
          savedItems.push({ name, pattern, replacement }); // æ·»åŠ æ–°çš„å­˜æ¡£é¡¹
        }
        localStorage.setItem(
          SAVED_REGEX_LOCALSTORAGE_KEY,
          JSON.stringify(savedItems)
        ); // å°†æ›´æ–°åçš„å­˜æ¡£æ•°ç»„å­˜å› localStorage
        loadSavedRegexes(); // é‡æ–°åŠ è½½å¹¶æ˜¾ç¤ºå­˜æ¡£åˆ—è¡¨
        alert(`å­˜æ¡£ "${name}" å·²ä¿å­˜!`);

        // è‡ªåŠ¨é€‰ä¸­åˆšåˆšä¿å­˜æˆ–è¦†ç›–çš„å­˜æ¡£é¡¹
        for (let i = 0; i < savedRegexSelect.options.length; i++) {
          if (
            savedRegexSelect.options[i].dataset.name === name &&
            savedRegexSelect.options[i].value === pattern && // æ¯”è¾ƒæ­£åˆ™
            savedRegexSelect.options[i].dataset.replacement === replacement
          ) {
            // æ¯”è¾ƒæ›¿æ¢å†…å®¹
            savedRegexSelect.selectedIndex = i; // è®¾ç½®ä¸ºé€‰ä¸­
            break;
          }
        }
      });

      /**
       * @event savedRegexSelect 'change'
       * @description å¤„ç†å·²å­˜æ¡£æ­£åˆ™è¡¨è¾¾å¼ä¸‹æ‹‰åˆ—è¡¨çš„é€‰æ‹©æ›´æ”¹äº‹ä»¶ã€‚
       *              å½“ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªå­˜æ¡£é¡¹æ—¶ï¼Œå°†å…¶å¯¹åº”çš„æ­£åˆ™è¡¨è¾¾å¼ã€å­˜æ¡£åç§°å’Œæ›¿æ¢å†…å®¹å¡«å……åˆ°ç›¸åº”çš„è¾“å…¥æ¡†ä¸­ã€‚
       */
      savedRegexSelect.addEventListener("change", () => {
        const selectedOption =
          savedRegexSelect.options[savedRegexSelect.selectedIndex]; // è·å–å½“å‰é€‰ä¸­çš„ option
        // æ£€æŸ¥ data-name æ˜¯å¦å­˜åœ¨ï¼Œä½œä¸ºæœ‰æ•ˆé€‰é¡¹çš„æ ‡å¿—ï¼ˆå› ä¸º value å¯èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚åªå­˜äº†æ›¿æ¢å†…å®¹ï¼‰
        if (selectedOption.dataset.name) {
          // å¦‚æœæ˜¯æœ‰æ•ˆçš„å­˜æ¡£é¡¹ï¼ˆéé»˜è®¤æç¤ºé€‰é¡¹ï¼‰
          regexInput.value = selectedOption.value || ""; // å¡«å……æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†ï¼Œè‹¥æ­£åˆ™ä¸ºç©ºåˆ™å¡«ç©ºå­—ç¬¦ä¸²
          regexNameInput.value = selectedOption.dataset.name || ""; // å¡«å……å­˜æ¡£åç§°è¾“å…¥æ¡†
          replaceInput.value =
            selectedOption.dataset.replacement !== undefined
              ? selectedOption.dataset.replacement
              : ""; // å¡«å……æ›¿æ¢å†…å®¹è¾“å…¥æ¡†ï¼Œè‹¥æœªå®šä¹‰åˆ™ä¸ºç©ºå­—ç¬¦ä¸²
        } else {
          // å¦‚æœé€‰æ‹©çš„æ˜¯é»˜è®¤æç¤ºé€‰é¡¹
          regexInput.value = ""; // æ¸…ç©ºæ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†
          regexNameInput.value = ""; // æ¸…ç©ºå­˜æ¡£åç§°è¾“å…¥æ¡†
          replaceInput.value = ""; // æ¸…ç©ºæ›¿æ¢å†…å®¹è¾“å…¥æ¡†
        }
        updateButtonStates(); // é‡æ–°è¯„ä¼°å’Œæ›´æ–°æŒ‰é’®çš„ç¦ç”¨çŠ¶æ€
      });

      /**
       * @event deleteRegexBtn 'click'
       * @description å¤„ç†â€œåˆ é™¤é€‰ä¸­â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              åˆ é™¤åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰ä¸­çš„å­˜æ¡£é¡¹ï¼ˆä» localStorage ä¸­ç§»é™¤ï¼‰ã€‚
       */
      deleteRegexBtn.addEventListener("click", () => {
        const selectedOption =
          savedRegexSelect.options[savedRegexSelect.selectedIndex]; // è·å–å½“å‰é€‰ä¸­çš„ option
        if (!selectedOption || !selectedOption.dataset.name) {
          // å¦‚æœæ²¡æœ‰é€‰ä¸­æœ‰æ•ˆå­˜æ¡£é¡¹
          alert("è¯·å…ˆä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªè¦åˆ é™¤çš„å­˜æ¡£ã€‚");
          return;
        }
        const regexNameToDelete = selectedOption.dataset.name; // è·å–è¦åˆ é™¤çš„å­˜æ¡£åç§°
        if (
          confirm(
            `ç¡®å®šè¦åˆ é™¤å­˜æ¡£ "${regexNameToDelete}" å—? (åŒ…å«å…¶æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹)`
          )
        ) {
          // ç¡®è®¤åˆ é™¤æ“ä½œ
          let savedItems = JSON.parse(
            localStorage.getItem(SAVED_REGEX_LOCALSTORAGE_KEY) || "[]"
          ); // è·å–æ‰€æœ‰å­˜æ¡£
          savedItems = savedItems.filter(
            (item) => item.name !== regexNameToDelete
          ); // è¿‡æ»¤æ‰è¦åˆ é™¤çš„å­˜æ¡£é¡¹
          localStorage.setItem(
            SAVED_REGEX_LOCALSTORAGE_KEY,
            JSON.stringify(savedItems)
          ); // ä¿å­˜æ›´æ–°åçš„å­˜æ¡£åˆ—è¡¨
          loadSavedRegexes(); // é‡æ–°åŠ è½½å­˜æ¡£åˆ—è¡¨
          // å¦‚æœå½“å‰è¾“å…¥æ¡†ä¸­çš„åç§°ä¸å·²åˆ é™¤çš„å­˜æ¡£åç§°ä¸€è‡´ï¼Œåˆ™æ¸…ç©ºç›¸å…³è¾“å…¥æ¡†
          if (regexNameInput.value === regexNameToDelete) {
            regexInput.value = "";
            regexNameInput.value = "";
            replaceInput.value = "";
          }
          alert(`å­˜æ¡£ "${regexNameToDelete}" å·²åˆ é™¤ã€‚`);
        }
      });

      // --- æœ¬åœ°å­˜å‚¨ (é¡µé¢çŠ¶æ€ï¼Œä¸åŒ…æ‹¬å­˜æ¡£åˆ—è¡¨) ---

      /**
       * @function saveState
       * @description å°†å½“å‰æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†ã€åŸæ–‡è¾“å…¥æ¡†å’Œæ›¿æ¢å†…å®¹è¾“å…¥æ¡†çš„å€¼ä¿å­˜åˆ° localStorageã€‚
       *              ç”¨äºåœ¨é¡µé¢åˆ·æ–°åæ¢å¤ç”¨æˆ·è¾“å…¥ã€‚
       */
      function saveState() {
        localStorage.setItem("textProcessorRegexInput", regexInput.value); // ä¿å­˜æ­£åˆ™è¡¨è¾¾å¼
        localStorage.setItem("textProcessorInputText", inputText.value); // ä¿å­˜åŸæ–‡
        localStorage.setItem("textProcessorReplaceInput", replaceInput.value); // ä¿å­˜æ›¿æ¢å†…å®¹
      }

      /**
       * @function loadState
       * @description ä» localStorage åŠ è½½ä¹‹å‰ä¿å­˜çš„é¡µé¢çŠ¶æ€ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ã€åŸæ–‡ã€æ›¿æ¢å†…å®¹ï¼‰ï¼Œ
       *              å¹¶å¡«å……åˆ°ç›¸åº”çš„è¾“å…¥æ¡†ä¸­ã€‚åŒæ—¶åˆå§‹åŒ– `textForOutputProcessing`ã€‚
       */
      function loadState() {
        regexInput.value =
          localStorage.getItem("textProcessorRegexInput") || ""; // åŠ è½½æ­£åˆ™è¡¨è¾¾å¼ï¼Œè‹¥æ— åˆ™ä¸ºç©º
        inputText.value = localStorage.getItem("textProcessorInputText") || ""; // åŠ è½½åŸæ–‡ï¼Œè‹¥æ— åˆ™ä¸ºç©º
        replaceInput.value =
          localStorage.getItem("textProcessorReplaceInput") || ""; // åŠ è½½æ›¿æ¢å†…å®¹ï¼Œè‹¥æ— åˆ™ä¸ºç©º

        if (inputText.value) {
          // å¦‚æœåŸæ–‡è¾“å…¥æ¡†ä¸­æœ‰å†…å®¹
          textForOutputProcessing = inputText.value; // åˆå§‹åŒ– textForOutputProcessing ä¸ºåŸæ–‡å†…å®¹
          updateOutputDisplay(textForOutputProcessing, false); // åœ¨è¾“å‡ºåŒºæ˜¾ç¤ºåŸæ–‡ï¼Œä¸è¿›è¡Œé«˜äº®
        } else {
          // å¦‚æœåŸæ–‡è¾“å…¥æ¡†ä¸ºç©º
          textForOutputProcessing = ""; // åˆå§‹åŒ– textForOutputProcessing ä¸ºç©ºå­—ç¬¦ä¸²
          outputTextDisplay.innerHTML = "å¤„ç†åçš„æ–‡æœ¬å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."; // æ˜¾ç¤ºå ä½æç¤º
        }
      }

      // --- ä¸»é¢˜åˆ‡æ¢ ---

      /**
       * @function toggleTheme
       * @description åˆ‡æ¢é¡µé¢çš„æ˜æš—ä¸»é¢˜ï¼Œå¹¶å°†é€‰æ‹©çš„ä¸»é¢˜ä¿å­˜åˆ° localStorageã€‚
       */
      function toggleTheme() {
        document.body.classList.toggle("dark-theme"); // åˆ‡æ¢ body ä¸Šçš„ 'dark-theme' ç±»
        // å°†å½“å‰ä¸»é¢˜çŠ¶æ€ ('dark' æˆ– 'light') ä¿å­˜åˆ° localStorage
        localStorage.setItem(
          "textProcessorTheme",
          document.body.classList.contains("dark-theme") ? "dark" : "light"
        );
      }

      /**
       * @function applyInitialTheme
       * @description åœ¨é¡µé¢åŠ è½½æ—¶ï¼Œä» localStorage è¯»å–ä¹‹å‰ä¿å­˜çš„ä¸»é¢˜è®¾ç½®å¹¶åº”ç”¨ã€‚
       */
      function applyInitialTheme() {
        const savedTheme = localStorage.getItem("textProcessorTheme"); // è¯»å–ä¿å­˜çš„ä¸»é¢˜
        if (savedTheme === "dark") {
          // å¦‚æœä¿å­˜çš„æ˜¯æš—é»‘ä¸»é¢˜
          document.body.classList.add("dark-theme"); // åº”ç”¨æš—é»‘ä¸»é¢˜ç±»
        }
      }

      applyInitialTheme(); // é¡µé¢åŠ è½½æ—¶åº”ç”¨åˆå§‹ä¸»é¢˜
      themeToggleBtn.addEventListener("click", toggleTheme); // ä¸ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬

      // --- äº‹ä»¶ç›‘å¬å™¨ (è¾“å…¥æ¡†å†…å®¹å˜åŒ–ã€æŒ‰é’®ç‚¹å‡»ç­‰) ---

      // å½“æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶ï¼Œä¿å­˜é¡µé¢çŠ¶æ€
      regexInput.addEventListener("input", saveState);

      /**
       * @event inputText 'input'
       * @description å¤„ç†åŸæ–‡è¾“å…¥æ¡†å†…å®¹æ”¹å˜äº‹ä»¶ã€‚
       *              æ›´æ–° `textForOutputProcessing`ï¼Œåœ¨è¾“å‡ºåŒºæ˜¾ç¤ºæ–°åŸæ–‡ï¼ˆæ— é«˜äº®ï¼‰ï¼Œ
       *              æ¸…ç©ºå½“å‰åŒ¹é…é¡¹ï¼Œæ›´æ–°æŒ‰é’®çŠ¶æ€ï¼Œå¹¶ä¿å­˜é¡µé¢çŠ¶æ€ã€‚
       */
      inputText.addEventListener("input", () => {
        const newRawText = inputText.value; // è·å–æ–°çš„åŸæ–‡å†…å®¹
        textForOutputProcessing = newRawText; // æ›´æ–°æ“ä½œçš„åŸºç¡€æ–‡æœ¬
        updateOutputDisplay(newRawText, false); // åœ¨è¾“å‡ºåŒºæ˜¾ç¤ºæ–°çš„åŸæ–‡ï¼Œä¸è¿›è¡Œé«˜äº®
        currentMatches = []; // åŸæ–‡æ”¹å˜ï¼Œä¹‹å‰çš„åŒ¹é…ç»“æœå¤±æ•ˆï¼Œæ¸…ç©º
        updateButtonStates(); // æ›´æ–°ç›¸å…³æŒ‰é’®ï¼ˆå¦‚æ›¿æ¢æŒ‰é’®ï¼‰çš„å¯ç”¨çŠ¶æ€
        saveState(); // ä¿å­˜å½“å‰é¡µé¢çŠ¶æ€
        currentMatchIndex = -1;
        updateMinimap([], textForOutputProcessing); // åŸæ–‡æ”¹å˜ï¼Œæ¸…ç©ºè¿·ä½ åœ°å›¾æ ‡è®°
      });

      // å½“æ›¿æ¢å†…å®¹è¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶ï¼Œä¿å­˜é¡µé¢çŠ¶æ€
      replaceInput.addEventListener("input", saveState);

      /**
       * @event outputTextDisplay 'input'
       * @description å¤„ç†å¤„ç†åæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ (contenteditable div) å†…å®¹æ”¹å˜äº‹ä»¶ã€‚
       *              å½“ç”¨æˆ·ç›´æ¥ç¼–è¾‘æ­¤åŒºåŸŸæ—¶ï¼Œæ›´æ–° `textForOutputProcessing`ï¼Œ
       *              æ¸…ç©ºå½“å‰åŸºäºæ­£åˆ™çš„åŒ¹é…é¡¹ï¼ˆå› ä¸ºæ–‡æœ¬å·²æ‰‹åŠ¨æ›´æ”¹ï¼‰ï¼Œå¹¶æ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
       */
      outputTextDisplay.addEventListener("input", () => {
        textForOutputProcessing = outputTextDisplay.innerText; // æ›´æ–°æ“ä½œçš„åŸºç¡€æ–‡æœ¬ä¸ºç”¨æˆ·ç¼–è¾‘åçš„å†…å®¹
        currentMatches = []; // ç›´æ¥ç¼–è¾‘ä¼šä½¿ä¹‹å‰åŸºäºæ­£åˆ™çš„åŒ¹é…å¤±æ•ˆï¼Œæ¸…ç©º
        updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
        copyModifiedBtn.disabled = outputTextDisplay.innerText.trim() === ""; // å¦‚æœç¼–è¾‘åä¸ºç©ºï¼Œç¦ç”¨å¤åˆ¶æŒ‰é’®
        currentMatchIndex = -1;
        updateMinimap([], textForOutputProcessing); // è¾“å‡ºåŒºç›´æ¥ç¼–è¾‘ï¼Œæ¸…ç©ºè¿·ä½ åœ°å›¾æ ‡è®°
      });

      /**
       * @event pasteBtn 'click'
       * @description å¤„ç†â€œç²˜è´´å‰ªè´´æ¿å†…å®¹åˆ°åŸæ–‡â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              å°è¯•ä»å‰ªè´´æ¿è¯»å–æ–‡æœ¬ï¼Œå¹¶å°†å…¶è®¾ç½®åˆ°åŸæ–‡è¾“å…¥æ¡†å’Œ `textForOutputProcessing`ï¼Œ
       *              ç„¶åæ›´æ–°è¾“å‡ºæ˜¾ç¤ºåŒºã€æ¸…ç©ºåŒ¹é…ã€æ›´æ–°æŒ‰é’®çŠ¶æ€å¹¶ä¿å­˜é¡µé¢çŠ¶æ€ã€‚
       */
      pasteBtn.addEventListener("click", async () => {
        try {
          const text = await navigator.clipboard.readText(); // å¼‚æ­¥è¯»å–å‰ªè´´æ¿æ–‡æœ¬
          inputText.value = text; // è®¾ç½®åˆ°åŸæ–‡è¾“å…¥æ¡†
          textForOutputProcessing = text; // æ›´æ–°æ“ä½œçš„åŸºç¡€æ–‡æœ¬
          updateOutputDisplay(text, false); // åœ¨è¾“å‡ºåŒºæ˜¾ç¤ºç²˜è´´çš„æ–‡æœ¬ï¼Œä¸è¿›è¡Œé«˜äº®
          currentMatches = []; // æ¸…ç©ºä¹‹å‰çš„åŒ¹é…ç»“æœ
          updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
          saveState(); // ä¿å­˜é¡µé¢çŠ¶æ€
          alert(
            "æ–‡æœ¬å·²ç²˜è´´åˆ°åŸæ–‡è¾“å…¥æ¡†ï¼Œå¹¶å·²åŒæ­¥æ˜¾ç¤ºåœ¨ä¸‹æ–¹å¤„ç†åŒºã€‚è¯·ä½¿ç”¨â€œæŸ¥æ‰¾â€æŒ‰é’®è¿›è¡ŒåŒ¹é…å’Œé«˜äº®æ“ä½œã€‚"
          );
        } catch (err) {
          console.error("æ— æ³•ç²˜è´´æ–‡æœ¬: ", err);
          alert(
            "æ— æ³•ä»å‰ªè´´æ¿ç²˜è´´æ–‡æœ¬ã€‚è¯·ç¡®ä¿å·²æˆäºˆå‰ªè´´æ¿æƒé™ï¼Œæˆ–æ‚¨çš„æµè§ˆå™¨æ”¯æŒæ­¤åŠŸèƒ½ã€‚"
          );
        }
      });

      /**
       * @function navigateMatches
       * @description å¤„ç†ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹çš„å¯¼èˆªã€‚
       * @param {number} direction - 1 è¡¨ç¤ºä¸‹ä¸€ä¸ªï¼Œ-1 è¡¨ç¤ºä¸Šä¸€ä¸ªã€‚
       */
      function navigateMatches(direction) {
        if (currentMatches.length === 0) return;

        const oldMatchIndex = currentMatchIndex;

        if (direction === 1) {
          // Next
          currentMatchIndex++;
          if (currentMatchIndex >= currentMatches.length) {
            currentMatchIndex = 0; // å¾ªç¯åˆ°ç¬¬ä¸€ä¸ª
          }
        } else if (direction === -1) {
          // Previous
          currentMatchIndex--;
          if (currentMatchIndex < 0) {
            currentMatchIndex = currentMatches.length - 1; // å¾ªç¯åˆ°æœ€åä¸€ä¸ª
          }
        }

        const matchToScroll = currentMatches[currentMatchIndex];
        if (matchToScroll && matchToScroll.spanId) {
          const targetSpan = document.getElementById(matchToScroll.spanId);
          if (targetSpan) {
            targetSpan.scrollIntoView({ behavior: "smooth", block: "center" });
            // ä¸´æ—¶é«˜äº®è·³è½¬åˆ°çš„åŒ¹é…é¡¹
            targetSpan.classList.add("scrolled-to");
            setTimeout(() => {
              targetSpan.classList.remove("scrolled-to");
            }, 1500);
          }
        }
        updateMinimap(currentMatches, textForOutputProcessing); // æ›´æ–°è¿·ä½ åœ°å›¾ä»¥é«˜äº®æ–°é€‰ä¸­çš„æ ‡è®°
        updateButtonStates(); // æ›´æ–°å¯¼èˆªæŒ‰é’®çš„ç¦ç”¨çŠ¶æ€
      }

      prevMatchBtn.addEventListener("click", () => navigateMatches(-1));
      nextMatchBtn.addEventListener("click", () => navigateMatches(1));

      /**
       * @event findBtn 'click'
       * @description å¤„ç†â€œæŸ¥æ‰¾â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†ä¸­çš„æ¨¡å¼ï¼Œåœ¨ `textForOutputProcessing` (å½“å‰å·¥ä½œæ–‡æœ¬) ä¸­æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹ã€‚
       *              å¦‚æœæ­£åˆ™ä¸ºç©ºï¼Œåˆ™ä»…æ›´æ–°æ˜¾ç¤ºä¸ºå½“å‰æ–‡æœ¬ï¼ˆæ— é«˜äº®ï¼‰ã€‚
       *              æŸ¥æ‰¾åˆ°çš„åŒ¹é…é¡¹å­˜å‚¨åœ¨ `currentMatches` ä¸­ï¼Œå¹¶åœ¨è¾“å‡ºåŒºé«˜äº®æ˜¾ç¤ºã€‚
       *              æœ€åæ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
       */
      findBtn.addEventListener("click", () => {
        const pattern = regexInput.value; // è·å–æ­£åˆ™è¡¨è¾¾å¼

        // å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸ºç©ºï¼Œåˆ™ä¸è¿›è¡ŒæŸ¥æ‰¾ï¼Œä»…æ›´æ–°æ˜¾ç¤ºä¸ºå½“å‰æ–‡æœ¬ï¼ˆæ— é«˜äº®ï¼‰
        if (!pattern.trim()) {
          updateOutputDisplay(textForOutputProcessing, false); // æ˜¾ç¤ºå½“å‰æ–‡æœ¬ï¼Œæ— é«˜äº®
          currentMatches = []; // æ¸…ç©ºåŒ¹é…é¡¹
          updateMinimap([], textForOutputProcessing); // æ¸…ç©ºè¿·ä½ åœ°å›¾
          currentMatchIndex = -1;
          updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
          return;
        }

        try {
          const regex = new RegExp(pattern, "g"); // åˆ›å»ºå…¨å±€åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
          currentMatches = []; // æ¸…ç©ºä¹‹å‰çš„åŒ¹é…ç»“æœ
          let match;
          // åœ¨ textForOutputProcessing (å½“å‰å·¥ä½œæ–‡æœ¬) ä¸­å¾ªç¯æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹
          while ((match = regex.exec(textForOutputProcessing)) !== null) {
            currentMatches.push({
              // å­˜å‚¨æ¯ä¸ªåŒ¹é…é¡¹çš„ä¿¡æ¯
              index: match.index, // åŒ¹é…é¡¹çš„èµ·å§‹ç´¢å¼•
              text: match[0], // åŒ¹é…åˆ°çš„æ–‡æœ¬
              length: match[0].length, // åŒ¹é…æ–‡æœ¬çš„é•¿åº¦
              // spanId å°†åœ¨ä¸‹é¢æ·»åŠ 
            });
          }

          // ä¸ºæ¯ä¸ªåŒ¹é…é¡¹åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ spanIdï¼Œç”¨äºåç»­å®šä½
          currentMatches.forEach((match, index) => {
            match.spanId = `highlight-match-${index}`;
          });

          highlightMatchesInOutput(textForOutputProcessing, currentMatches); // é«˜äº®æ˜¾ç¤ºæ‰€æœ‰æ‰¾åˆ°çš„åŒ¹é…é¡¹
          updateMinimap(currentMatches, textForOutputProcessing); // æ›´æ–°è¿·ä½ åœ°å›¾
          currentMatchIndex = -1; // é‡ç½®é€‰ä¸­ç´¢å¼•
          updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€,åŒ…æ‹¬å¯¼èˆªæŒ‰é’®
        } catch (e) {
          // æ•è·æ— æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼é”™è¯¯
          alert("æ— æ•ˆçš„æ­£åˆ™è¡¨è¾¾å¼: " + e.message);
          updateOutputDisplay(textForOutputProcessing, false); // å‡ºé”™æ—¶æ˜¾ç¤ºå½“å‰æ–‡æœ¬ï¼Œæ— é«˜äº®
          currentMatches = []; // æ¸…ç©ºåŒ¹é…é¡¹
          updateMinimap([], textForOutputProcessing); // æ¸…ç©ºè¿·ä½ åœ°å›¾
          currentMatchIndex = -1;
          updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
        }
      });

      /**
       * @function highlightMatchesInOutput
       * @description æ ¹æ®æä¾›çš„æ–‡æœ¬å’ŒåŒ¹é…é¡¹æ•°ç»„ï¼Œåœ¨ outputTextDisplay ä¸­é«˜äº®æ˜¾ç¤ºåŒ¹é…éƒ¨åˆ†ã€‚
       * @param {string} textToHighlight - éœ€è¦è¿›è¡Œé«˜äº®å¤„ç†çš„åŸå§‹æ–‡æœ¬ã€‚
       * @param {Array<Object>} matches - åŒ¹é…é¡¹æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡åŒ…å« {index, text, length}ã€‚
       */
      function highlightMatchesInOutput(textToHighlight, matches) {
        if (!matches || matches.length === 0) {
          // å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹
          updateOutputDisplay(textToHighlight, false); // ç›´æ¥æ˜¾ç¤ºçº¯æ–‡æœ¬ï¼Œä¸è¿›è¡Œé«˜äº®å¤„ç†
          return;
        }
        let highlightedHtml = ""; // ç”¨äºæ„å»ºåŒ…å«é«˜äº®æ ‡ç­¾çš„ HTML å­—ç¬¦ä¸²
        let lastIndex = 0; // è®°å½•ä¸Šä¸€ä¸ªåŒ¹é…é¡¹ç»“æŸåçš„ç´¢å¼•ä½ç½®
        // å‡è®¾ 'matches' æ•°ç»„ä¸­çš„å¯¹è±¡å·²ç»æœ‰äº† 'spanId' å±æ€§
        // å¹¶ä¸”å®ƒä»¬æ˜¯æŒ‰ match.index æ’åºçš„ï¼ˆfindBtn ä¸­çš„ regex.exec è‡ªç„¶ä¿è¯äº†è¿™ä¸€ç‚¹ï¼‰

        matches.forEach((match) => {
          highlightedHtml += escapeHtml(
            textToHighlight.substring(lastIndex, match.index)
          );
          // ä½¿ç”¨ match.spanId ä¸º span è®¾ç½® ID
          highlightedHtml += `<span class="highlight" id="${
            match.spanId
          }">${escapeHtml(match.text)}</span>`;
          lastIndex = match.index + match.length;
        });
        highlightedHtml += escapeHtml(textToHighlight.substring(lastIndex));
        outputTextDisplay.innerHTML = highlightedHtml;
        copyModifiedBtn.disabled = outputTextDisplay.innerText.trim() === "";
      }

      /**
       * @function updateMinimap
       * @description æ›´æ–°è¿·ä½ åœ°å›¾ä¸Šçš„æ ‡è®°ä»¥åæ˜ å½“å‰æ–‡æœ¬ä¸­çš„åŒ¹é…é¡¹ã€‚
       * @param {Array<Object>} matches - å½“å‰çš„åŒ¹é…é¡¹æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡åº”åŒ…å« { index, spanId }ã€‚
       * @param {string} fullText - å®Œæ•´çš„å·¥ä½œæ–‡æœ¬ (textForOutputProcessing)ã€‚
       */
      function updateMinimap(matches, fullText) {
        minimapContainer.innerHTML = "";
        const minimapHeight = minimapContainer.clientHeight;
        const markHeight = 3;

        if (
          !matches ||
          matches.length === 0 ||
          !fullText ||
          fullText.length === 0 ||
          minimapHeight <= 0
        ) {
          return;
        }
        const totalTextLength = fullText.length;
        if (totalTextLength === 0) return;

        matches.forEach((match, index) => {
          if (match.index === undefined || !match.spanId) return;

          const mark = document.createElement("div");
          mark.className = "minimap-mark";
          if (index === currentMatchIndex) {
            // å¦‚æœæ˜¯å½“å‰é€‰ä¸­çš„åŒ¹é…é¡¹
            mark.classList.add("selected");
          }

          let topPosition = (match.index / totalTextLength) * minimapHeight;
          topPosition = Math.max(
            0,
            Math.min(topPosition, minimapHeight - markHeight)
          );
          mark.style.top = `${topPosition}px`;

          mark.addEventListener("click", () => {
            currentMatchIndex = index; // ç‚¹å‡»è¿·ä½ åœ°å›¾æ ‡è®°ä¹Ÿæ›´æ–°å½“å‰é€‰ä¸­ç´¢å¼•
            const targetSpan = document.getElementById(match.spanId);
            if (targetSpan) {
              targetSpan.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
              targetSpan.classList.add("scrolled-to");
              setTimeout(() => {
                targetSpan.classList.remove("scrolled-to");
              }, 1500);
            }
            updateMinimap(currentMatches, textForOutputProcessing); // é‡æ–°æ¸²æŸ“è¿·ä½ åœ°å›¾ä»¥æ›´æ–°é€‰ä¸­çŠ¶æ€
            updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
          });
          minimapContainer.appendChild(mark);
        });
      }

      /**
       * @function escapeHtml
       * @description å¯¹å­—ç¬¦ä¸²è¿›è¡Œ HTML è½¬ä¹‰ï¼Œé˜²æ­¢ XSS æ”»å‡»å’Œç¡®ä¿ç‰¹æ®Šå­—ç¬¦æ­£ç¡®æ˜¾ç¤ºã€‚
       * @param {string} unsafe - å¯èƒ½åŒ…å« HTML ç‰¹æ®Šå­—ç¬¦çš„ä¸å®‰å…¨å­—ç¬¦ä¸²ã€‚
       * @returns {string} è½¬ä¹‰åçš„å®‰å…¨å­—ç¬¦ä¸²ã€‚
       */
      function escapeHtml(unsafe) {
        if (unsafe === null || unsafe === undefined) return ""; // å¤„ç† null æˆ– undefined è¾“å…¥
        return unsafe
          .replace(/&/g, "&amp;") // æ›¿æ¢ &
          .replace(/</g, "&lt;") // æ›¿æ¢ <
          .replace(/>/g, "&gt;") // æ›¿æ¢ >
          .replace(/"/g, "&quot;") // æ›¿æ¢ "
          .replace(/'/g, "&#039;"); // æ›¿æ¢ '
      }

      /**
       * @function updateOutputDisplay
       * @description æ›´æ–° outputTextDisplay å…ƒç´ çš„å†…å®¹ã€‚
       *              å¦‚æœéœ€è¦é«˜äº®ä¸”å­˜åœ¨åŒ¹é…é¡¹å’Œæœ‰æ•ˆæ­£åˆ™ï¼Œåˆ™è°ƒç”¨ highlightMatchesInOutputã€‚
       *              å¦åˆ™ï¼Œç›´æ¥æ˜¾ç¤ºè½¬ä¹‰åçš„çº¯æ–‡æœ¬ã€‚
       * @param {string} text - è¦æ˜¾ç¤ºçš„æ–‡æœ¬ã€‚
       * @param {boolean} [performsHighlighting=true] - æ˜¯å¦å°è¯•è¿›è¡Œé«˜äº®ã€‚
       */
      function updateOutputDisplay(text, performsHighlighting = true) {
        // åªæœ‰å½“æ˜ç¡®éœ€è¦é«˜äº®ã€å½“å‰å­˜åœ¨åŒ¹é…é¡¹ã€å¹¶ä¸”æ­£åˆ™è¡¨è¾¾å¼è¾“å…¥æ¡†ä¸ä¸ºç©ºæ—¶ï¼Œæ‰è¿›è¡Œé«˜äº®å¤„ç†
        if (
          performsHighlighting &&
          currentMatches.length > 0 &&
          regexInput.value.trim()
        ) {
          highlightMatchesInOutput(text, currentMatches); // è°ƒç”¨é«˜äº®å‡½æ•°
        } else {
          outputTextDisplay.innerHTML = escapeHtml(text); // å¦åˆ™ï¼Œæ˜¾ç¤ºç»è¿‡ HTML è½¬ä¹‰çš„çº¯æ–‡æœ¬
        }
        // æ›´æ–°å¤åˆ¶æŒ‰é’®çš„ç¦ç”¨çŠ¶æ€ï¼šå¦‚æœè¾“å‡ºåŒºå†…å®¹ä¸ºç©ºæˆ–ä¸ºåˆå§‹å ä½ç¬¦ï¼Œåˆ™ç¦ç”¨
        copyModifiedBtn.disabled =
          outputTextDisplay.innerText.trim() === "" ||
          outputTextDisplay.innerHTML === "å¤„ç†åçš„æ–‡æœ¬å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...";
      }

      /**
       * @event replaceNextBtn 'click'
       * @description å¤„ç†â€œæ›¿æ¢ä¸‹ä¸€ä¸ªâ€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              ä½¿ç”¨å½“å‰æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢æ–‡æœ¬ï¼Œåœ¨ `textForOutputProcessing` ä¸­æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚
       *              æ›¿æ¢åï¼Œæ›´æ–° `textForOutputProcessing`ï¼Œé‡æ–°æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹å¹¶é«˜äº®ï¼Œç„¶åæ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
       */
      replaceNextBtn.addEventListener("click", () => {
        const patternString = regexInput.value; // è·å–æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
        const replacementText = replaceInput.value; // è·å–æ›¿æ¢æ–‡æœ¬

        // å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸ºç©ºæˆ–å½“å‰æ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™æç¤ºç”¨æˆ·å¹¶è¿”å›
        if (!patternString.trim() || currentMatches.length === 0) {
          alert("æ²¡æœ‰æ‰¾åˆ°å¯æ›¿æ¢çš„åŒ¹é…é¡¹ã€‚è¯·å…ˆæ‰§è¡Œâ€œæŸ¥æ‰¾â€ã€‚");
          return;
        }
        try {
          const regex = new RegExp(patternString); // åˆ›å»ºä¸€ä¸ªéå…¨å±€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…
          if (regex.test(textForOutputProcessing)) {
            // æ£€æŸ¥å½“å‰å·¥ä½œæ–‡æœ¬ä¸­æ˜¯å¦å­˜åœ¨è‡³å°‘ä¸€ä¸ªåŒ¹é…é¡¹
            // æ‰§è¡Œæ›¿æ¢æ“ä½œï¼Œåªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹
            const newText = textForOutputProcessing.replace(
              regex,
              replacementText
            );
            textForOutputProcessing = newText; // å…³é”®ï¼šæ›´æ–°å·¥ä½œæ–‡æœ¬ä¸ºæ›¿æ¢åçš„æ–‡æœ¬

            // æ›¿æ¢åï¼Œéœ€è¦åŸºäºæ›´æ–°åçš„ textForOutputProcessing é‡æ–°æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹
            const globalRegex = new RegExp(patternString, "g"); // ä½¿ç”¨å…¨å±€æ­£åˆ™é‡æ–°æŸ¥æ‰¾
            currentMatches = []; // æ¸…ç©ºæ—§çš„åŒ¹é…é¡¹åˆ—è¡¨
            let match;
            while (
              (match = globalRegex.exec(textForOutputProcessing)) !== null
            ) {
              // æŸ¥æ‰¾æ‰€æœ‰æ–°åŒ¹é…é¡¹
              currentMatches.push({
                index: match.index,
                text: match[0],
                length: match[0].length,
              });
            }
            // é«˜äº®æ˜¾ç¤ºæ›´æ–°åçš„å·¥ä½œæ–‡æœ¬åŠå…¶æ–°çš„åŒ¹é…é¡¹
            currentMatches.forEach(
              (m, idx) => (m.spanId = `highlight-match-${idx}`)
            ); // é‡æ–°åˆ†é… spanId
            highlightMatchesInOutput(textForOutputProcessing, currentMatches);
            currentMatchIndex = -1;
            updateMinimap(currentMatches, textForOutputProcessing); // æ›´æ–°è¿·ä½ åœ°å›¾
            updateButtonStates();
          } else {
            // æ­¤æƒ…å†µç†è®ºä¸Šä¸åº”å‘ç”Ÿï¼Œå› ä¸ºæŒ‰é’®å¯ç”¨æ¡ä»¶æ˜¯ currentMatches.length > 0
            // ä½†ä½œä¸ºé˜²å¾¡æ€§ç¼–ç¨‹ï¼Œå¦‚æœ textForOutputProcessing è¢«æ„å¤–ä¿®æ”¹å¯¼è‡´æ— åŒ¹é…ï¼Œåˆ™æç¤º
            alert("åœ¨å½“å‰å¤„ç†æ–‡æœ¬ä¸­æ²¡æœ‰æ›´å¤šå¯æ›¿æ¢çš„åŒ¹é…é¡¹ã€‚");
            currentMatches = []; // æ¸…ç†åŒ¹é…é¡¹
            currentMatchIndex = -1;
            highlightMatchesInOutput(textForOutputProcessing, currentMatches); // ç§»é™¤é«˜äº®
            updateMinimap(currentMatches, textForOutputProcessing); // æ¸…ç©ºè¿·ä½ åœ°å›¾
            updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
          }
        } catch (e) {
          // æ•è·æ›¿æ¢è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ï¼ˆå¦‚æ— æ•ˆæ­£åˆ™ï¼‰
          alert("æ›¿æ¢æ—¶å‘ç”Ÿé”™è¯¯: " + e.message);
        }
      });

      /**
       * @event replaceAllBtn 'click'
       * @description å¤„ç†â€œå…¨éƒ¨æ›¿æ¢â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              ä½¿ç”¨å½“å‰æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå…¨å±€æ¨¡å¼ï¼‰å’Œæ›¿æ¢æ–‡æœ¬ï¼Œåœ¨ `textForOutputProcessing` ä¸­æ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹ã€‚
       *              æ›¿æ¢åï¼Œæ›´æ–° `textForOutputProcessing`ï¼Œæ›´æ–°è¾“å‡ºåŒºæ˜¾ç¤ºï¼ˆæ— é«˜äº®ï¼‰ï¼Œæ¸…ç©ºåŒ¹é…é¡¹ï¼Œå¹¶æ›´æ–°æŒ‰é’®çŠ¶æ€ã€‚
       */
      replaceAllBtn.addEventListener("click", () => {
        const patternString = regexInput.value; // è·å–æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
        const replacementText = replaceInput.value; // è·å–æ›¿æ¢æ–‡æœ¬

        // å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸ºç©ºæˆ–å½“å‰æ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™æç¤ºç”¨æˆ·å¹¶è¿”å›
        if (!patternString.trim() || currentMatches.length === 0) {
          alert("æ²¡æœ‰æ‰¾åˆ°å¯æ›¿æ¢çš„åŒ¹é…é¡¹ã€‚è¯·å…ˆæ‰§è¡Œâ€œæŸ¥æ‰¾â€ã€‚");
          return;
        }
        try {
          const regex = new RegExp(patternString, "g"); // åˆ›å»ºå…¨å±€åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼
          if (regex.test(textForOutputProcessing)) {
            // æ£€æŸ¥å½“å‰å·¥ä½œæ–‡æœ¬ä¸­æ˜¯å¦æœ‰ä»»ä½•åŒ¹é…é¡¹
            // æ‰§è¡Œå…¨å±€æ›¿æ¢æ“ä½œ
            const newText = textForOutputProcessing.replace(
              regex,
              replacementText
            );
            textForOutputProcessing = newText; // å…³é”®ï¼šæ›´æ–°å·¥ä½œæ–‡æœ¬ä¸ºå…¨éƒ¨æ›¿æ¢åçš„æ–‡æœ¬
            updateOutputDisplay(textForOutputProcessing, false); // æ˜¾ç¤ºæ›¿æ¢åçš„æ–°æ–‡æœ¬ï¼Œä¸è¿›è¡Œé«˜äº®
            currentMatches = []; // å…¨éƒ¨æ›¿æ¢åï¼Œä¹‹å‰çš„åŒ¹é…é¡¹åˆ—è¡¨æ¸…ç©ºï¼Œå› ä¸ºæ–‡æœ¬ç»“æ„å·²å¤§è§„æ¨¡æ”¹å˜
            currentMatchIndex = -1;
            updateMinimap([], textForOutputProcessing); // æ¸…ç©ºè¿·ä½ åœ°å›¾ï¼Œå› ä¸ºé«˜äº®å·²ç§»é™¤
            updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼ˆé€šå¸¸ä¼šç¦ç”¨æ›¿æ¢æŒ‰é’®ï¼Œå› ä¸ºåŒ¹é…é¡¹å·²æ¸…ç©ºï¼‰
          } else {
            // æ­¤æƒ…å†µç†è®ºä¸Šä¸åº”å‘ç”Ÿï¼Œå› ä¸ºæŒ‰é’®å¯ç”¨æ¡ä»¶æ˜¯ currentMatches.length > 0
            alert("åœ¨å½“å‰å¤„ç†æ–‡æœ¬ä¸­æ²¡æœ‰åŒ¹é…é¡¹å¯æ›¿æ¢ã€‚");
            currentMatches = []; // ç¡®ä¿åŒ¹é…é¡¹æ¸…ç©º
            currentMatchIndex = -1;
            updateOutputDisplay(textForOutputProcessing, false); // ç¡®ä¿æ˜¾ç¤ºå½“å‰æ–‡æœ¬æ— é«˜äº®
            updateMinimap([], textForOutputProcessing); // æ¸…ç©ºè¿·ä½ åœ°å›¾
            updateButtonStates(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
          }
        } catch (e) {
          // æ•è·æ›¿æ¢è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯
          alert("å…¨éƒ¨æ›¿æ¢æ—¶å‘ç”Ÿé”™è¯¯: " + e.message);
        }
      });

      /**
       * @event copyModifiedBtn 'click'
       * @description å¤„ç†â€œå¤åˆ¶å¤„ç†åæ–‡æœ¬â€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚
       *              å°è¯•å°† outputTextDisplay ä¸­æ˜¾ç¤ºçš„çº¯æ–‡æœ¬å†…å®¹å¤åˆ¶åˆ°ç”¨æˆ·å‰ªè´´æ¿ã€‚
       */
      copyModifiedBtn.addEventListener("click", async () => {
        try {
          await navigator.clipboard.writeText(outputTextDisplay.innerText); // å¤åˆ¶ outputTextDisplay çš„çº¯æ–‡æœ¬å†…å®¹
          alert("å¤„ç†åçš„æ–‡æœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!");
        } catch (err) {
          console.error("æ— æ³•å¤åˆ¶æ–‡æœ¬: ", err);
          alert("æ— æ³•å¤åˆ¶æ–‡æœ¬ã€‚");
        }
      });

      /**
       * @function updateButtonStates
       * @description æ ¹æ®å½“å‰çŠ¶æ€ï¼ˆå¦‚æ˜¯å¦æœ‰æ­£åˆ™è¡¨è¾¾å¼ã€æ˜¯å¦æœ‰åŒ¹é…é¡¹ã€è¾“å‡ºåŒºæ˜¯å¦ä¸ºç©ºç­‰ï¼‰
       *              æ›´æ–°å„ä¸ªæŒ‰é’®ï¼ˆæ›¿æ¢ã€å…¨éƒ¨æ›¿æ¢ã€å¤åˆ¶ã€åˆ é™¤å­˜æ¡£ï¼‰çš„ç¦ç”¨ (disabled) çŠ¶æ€ã€‚
       */
      function updateButtonStates() {
        const hasPattern = regexInput.value.trim() !== "";
        const hasMatches = currentMatches.length > 0;

        replaceNextBtn.disabled = !hasMatches || !hasPattern;
        replaceAllBtn.disabled = !hasMatches || !hasPattern;

        copyModifiedBtn.disabled =
          outputTextDisplay.innerText.trim() === "" ||
          outputTextDisplay.innerHTML === "å¤„ç†åçš„æ–‡æœ¬å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...";
        copyOutputBtn.disabled = copyModifiedBtn.disabled;

        const selectedSavedOption =
          savedRegexSelect.options[savedRegexSelect.selectedIndex];
        deleteRegexBtn.disabled =
          !selectedSavedOption || !selectedSavedOption.dataset.name;

        // æ–°å¢ï¼šå¯¼èˆªæŒ‰é’®çŠ¶æ€
        prevMatchBtn.disabled = !hasMatches; // å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™ç¦ç”¨
        nextMatchBtn.disabled = !hasMatches; // å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™ç¦ç”¨
        // å¯é€‰ï¼šå¦‚æœåªæœ‰ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ç¦ç”¨ï¼Œæˆ–è€…è®©å®ƒä»¬å¾ªç¯
        // å½“å‰çš„ navigateMatches å®ç°æ˜¯å¾ªç¯çš„ï¼Œæ‰€ä»¥åªæœ‰åœ¨ no matches æ—¶æ‰ç¦ç”¨
      }

      // // --- å›åˆ°é¡¶éƒ¨æŒ‰é’®åŠŸèƒ½ ---
      // const scrollToTopBtn = document.getElementById("scrollToTopBtn");

      // // ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ§åˆ¶æŒ‰é’®æ˜¾ç¤ºéšè—
      // window.addEventListener("scroll", () => {
      //   // å½“é¡µé¢æ»šåŠ¨è¶…è¿‡300pxæ—¶æ˜¾ç¤ºæŒ‰é’®
      //   if (window.scrollY > 300) {
      //     scrollToTopBtn.style.display = "block";
      //   } else {
      //     scrollToTopBtn.style.display = "none";
      //   }
      // });

      // // ä¸ºæ ‡ç­¾æ—çš„å¤åˆ¶æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      // copyOutputBtn.addEventListener("click", async () => {
      //   try {
      //     await navigator.clipboard.writeText(outputTextDisplay.innerText);
      //     alert("å¤„ç†åçš„æ–‡æœ¬å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!");
      //   } catch (err) {
      //     console.error("æ— æ³•å¤åˆ¶æ–‡æœ¬: ", err);
      //     alert("æ— æ³•å¤åˆ¶æ–‡æœ¬ã€‚");
      //   }
      // });

      // // ç‚¹å‡»æŒ‰é’®æ»šåŠ¨åˆ°å¤„ç†åæ–‡æœ¬æ¡†é¡¶éƒ¨
      // scrollToTopBtn.addEventListener("click", () => {
      //   outputTextDisplay.scrollIntoView({ behavior: "smooth" });
      // });

      // --- outputTextDisplay å›åˆ°é¡¶éƒ¨æŒ‰é’®åŠŸèƒ½ ---
      outputTextDisplay.addEventListener("scroll", () => {
        if (outputTextDisplay.scrollTop > 150) {
          // æ»šåŠ¨è¶…è¿‡150pxæ—¶æ˜¾ç¤º
          outputScrollToTopBtn.style.display = "block";
        } else {
          outputScrollToTopBtn.style.display = "none";
        }
      });

      outputScrollToTopBtn.addEventListener("click", () => {
        outputTextDisplay.scrollTo({ top: 0, behavior: "smooth" });
      });

      // --- åˆå§‹åŒ– ---
      // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œçš„åˆå§‹åŒ–æ“ä½œã€‚
      loadState(); // åŠ è½½ä¹‹å‰ä¿å­˜çš„é¡µé¢çŠ¶æ€ï¼ˆè¾“å…¥æ¡†å†…å®¹ï¼‰ï¼Œä¼šåˆå§‹åŒ– textForOutputProcessingã€‚
      updateMinimap([], textForOutputProcessing); // åˆå§‹åŠ è½½æ—¶ï¼Œå¦‚æœæ— åŒ¹é…åˆ™æ¸…ç©º
      loadSavedRegexes(); // åŠ è½½å¹¶æ˜¾ç¤ºå·²å­˜æ¡£çš„æ­£åˆ™è¡¨è¾¾å¼å’Œæ›¿æ¢å†…å®¹åˆ—è¡¨ã€‚
      updateButtonStates(); // æ ¹æ®åŠ è½½åçš„çŠ¶æ€ï¼Œåˆå§‹åŒ–æ‰€æœ‰æŒ‰é’®çš„å¯ç”¨æ€§ã€‚

      // å…³äº textForOutputProcessing çš„åˆå§‹åŒ–è¯´æ˜:
      // 1. `loadState()` å‡½æ•°è´Ÿè´£ä» localStorage è¯»å– `inputText` çš„å€¼ã€‚
      // 2. å¦‚æœ `inputText` æœ‰å€¼ï¼Œ`textForOutputProcessing` ä¼šè¢«è®¾ç½®ä¸º `inputText.value`ï¼Œ
      //    å¹¶ä¸” `outputTextDisplay` ä¼šæ˜¾ç¤ºè¿™ä¸ªæ–‡æœ¬ï¼ˆæ— é«˜äº®ï¼‰ã€‚
      // 3. å¦‚æœ `inputText` ä¸ºç©ºï¼Œ`textForOutputProcessing` ä¼šè¢«è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œ
      //    `outputTextDisplay` ä¼šæ˜¾ç¤ºå ä½ç¬¦ã€‚
      // 4. ç”¨æˆ·å¯¹ `inputText` çš„è¾“å…¥ã€ç²˜è´´æ“ä½œï¼Œæˆ–å¯¹ `outputTextDisplay` çš„ç›´æ¥ç¼–è¾‘ï¼Œ
      //    ä»¥åŠæ›¿æ¢æ“ä½œï¼Œéƒ½ä¼šç›¸åº”åœ°æ›´æ–° `textForOutputProcessing`ã€‚
      // 5. `findBtn` çš„ç‚¹å‡»äº‹ä»¶ä¼šä½¿ç”¨å½“å‰çš„ `textForOutputProcessing` è¿›è¡ŒæŸ¥æ‰¾ã€‚
    </script>
  </body>
</html>
